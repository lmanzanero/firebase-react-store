{"version":3,"sources":["webpack://front-end/./src/components/cart/CartProduct.js","webpack://front-end/./src/pages/cart.js"],"names":["CartProduct","card","data","node","class","src","image","high","alt","name","description","href","viewBox","d","type","value","price","Cart","location","props","total","useContext","CartContext","products","addProduct","useState","totalSum","settotalSum","initalState","productId","referenceNumber","phone","promocode","orderDetails","setOrderDetails","isLoading","setLoading","setError","canSubmit","setCanSubmit","open","setOpen","cancelButtonRef","useRef","useEffect","length","reduce","a","b","addAllPrices","replace","push","Number","handleOrder","requestOptions","method","headers","body","JSON","stringify","fetch","then","response","ok","json","Error","navigate","state","referenceCode","catch","error","message","finally","handleChange","e","target","show","as","Fragment","static","className","initialFocus","onClose","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","aria-hidden","placeholder","onClick","ref","StaticQuery","query","render","allRestApiApiProducts","edges","map","product","key","includes","id","for","onChange","required","disabled"],"mappings":"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","file":"component---src-pages-cart-js-8fa0656db109734b647f.js","sourcesContent":["import React from 'react'\n\nexport default function CartProduct({ data }) {\n  const card = data.node;\n  return (\n      <div class=\"flex items-center hover:bg-gray-100 -mx-8 px-6 py-5\">\n          <div class=\"flex w-2/5\"> \n            <div class=\"w-40\">\n              <img class=\"h-24 object-cover\" src={card.image.high} alt=\"\" />\n            </div>\n            <div class=\"flex flex-col justify-between ml-4 flex-grow\">\n              <span class=\"font-bold text-sm\">{card.name}</span>\n              <span class=\"text-gray-600 text-xs\">{card.description}</span>\n              <a href=\"#\" class=\"font-semibold hover:text-red-500 text-gray-500 text-xs\">Remove</a>\n            </div>\n          </div>\n          <div class=\"flex justify-center w-1/5\">\n            <svg class=\"fill-current text-gray-600 w-3\" viewBox=\"0 0 448 512\"><path d=\"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z\"/>\n            </svg>\n\n            <input class=\"mx-2 border text-center w-8\" type=\"text\" value=\"1\"/>\n\n            <svg class=\"fill-current text-gray-600 w-3\" viewBox=\"0 0 448 512\">\n              <path d=\"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z\"/>\n            </svg>\n          </div>\n          <span class=\"text-center w-1/5 font-semibold text-sm\">{card.price}</span>\n          <span class=\"text-center w-1/5 font-semibold text-sm\">{card.price}</span>\n      </div>\n  )\n}\n","import React, { useState, useRef, Fragment, useEffect, useContext } from 'react'\nimport { Dialog, Transition } from '@headlessui/react'\nimport { graphql, StaticQuery } from \"gatsby\"\nimport { navigate } from \"gatsby\"\nimport Layout from '../components/layouts/layout'\nimport CartProduct from '../components/cart/CartProduct';  \nimport { CartContext } from '../services/context/CartContext'; \n\nexport default function Cart({ data, location, props }) {   \n  const total = []; \n  const {products, addProduct} = useContext(CartContext);\n  const [totalSum, settotalSum] = useState(total);\n  const initalState = {\n    productId: [...products],\n    referenceNumber: '',\n    name: '',\n    phone: '',\n    promocode: ''\n  }\n  const [orderDetails, setOrderDetails] = useState(initalState);\n  const [isLoading, setLoading ] = useState(false);\n  const [error, setError ] = useState({});\n  const [ canSubmit,  setCanSubmit ] = useState(true);\n  const [open, setOpen] = useState(false);\n  const cancelButtonRef = useRef();\n\n  useEffect(() => { \n      //todo: Expand on this validation with phone verfication\n     if(orderDetails.name === '' || orderDetails.phone === '' || orderDetails.phone?.length < 7 || orderDetails.phone.length > 7) {\n       setCanSubmit(true);\n     } else {\n       setCanSubmit(false); \n     }  \n  }, [orderDetails, products])\n\n  useEffect(() => {\n    //adds all values for final price\n    settotalSum(total.reduce((a, b) => a + b, 0));\n  }, []);\n\n  //gets all price values froms static query\n  const addAllPrices = async (price) => {\n    const value = price.replace(/\\$/g, '');  \n    total.push(Number(value)); \n  }\n\n  const handleOrder = async () => {\n    setLoading(true);\n    //send state values to api\n    const requestOptions = {\n      method: 'POST', \n      headers: { 'Content-Type': 'application/json'},\n      body: JSON.stringify({\n        \"productId\": `${orderDetails.productId}`,\n        \"name\": `${orderDetails.name}`,\n        \"phone\": `${orderDetails.phone}`, \n      })\n  };\n  return await fetch(`https://us-central1-nancy-s-jewerly.cloudfunctions.net/api/order`, requestOptions)\n        .then(response => { \n          if(response.ok) {\n            return response.json();\n          } else {\n            setOpen(true);\n            throw new Error(\"Please verify number\");\n          }\n        }).then((data) => {   \n          navigate(`/view-order`,\n            { state: {\n              referenceCode : data.referenceCode\n            }\n          });\n        }) \n        .catch(error => {  \n          setError(error.message);\n        }).finally(() => {\n          setLoading(false);\n        })\n    }\n\n    const handleChange = (e) => { \n      //spread value to keys \n      setOrderDetails({...orderDetails, [e.target.name]: e.target.value}) \n  }\n\n\n  return (\n    <Layout>\n        <Transition.Root show={open} as={Fragment}>\n          <Dialog\n            as=\"div\"\n            static\n            className=\"fixed z-10 inset-0 overflow-y-auto max-w\"\n            initialFocus={cancelButtonRef}\n            open={open}\n            onClose={setOpen}\n          >\n            <div className=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n              <Transition.Child\n                as={Fragment}\n                enter=\"ease-out duration-300\"\n                enterFrom=\"opacity-0\"\n                enterTo=\"opacity-100\"\n                leave=\"ease-in duration-200\"\n                leaveFrom=\"opacity-100\"\n                leaveTo=\"opacity-0\"\n              >\n                <Dialog.Overlay className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" />\n              </Transition.Child>\n\n              {/* This element is to trick the browser into centering the modal contents. */}\n              <span className=\"hidden sm:inline-block sm:align-middle sm:h-screen\" aria-hidden=\"true\">\n                &#8203;\n              </span>\n              <Transition.Child\n                as={Fragment}\n                enter=\"ease-out duration-300\"\n                enterFrom=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n                enterTo=\"opacity-100 translate-y-0 sm:scale-100\"\n                leave=\"ease-in duration-200\"\n                leaveFrom=\"opacity-100 translate-y-0 sm:scale-100\"\n                leaveTo=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n              >\n                <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle md:max-w-lg sm:w-full\">\n                  <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\"> \n                      <div className=\"mt-3 text-center sm:mt-0  sm:text-left\">\n                        <Dialog.Title as=\"h3\" className=\"text-lg leading-6 font-medium text-gray-900\">\n                          Verify Phone Number to create order\n                        </Dialog.Title> \n                        <br/> \n                      </div> \n                      <input type=\"text\" class=\"relative outline-none rounded py-4 px-3 w-full bg-white shadow text-base text-gray-700 placeholder-gray-400 focus:outline-none focus:shadow-outline\" placeholder=\"Enter **** code\"/>\n                  </div>\n                  <div className=\"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse\">\n                    <button\n                      type=\"button\"\n                      className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm\"\n                      onClick={() => setOpen(false)}\n                    >\n                      Verify\n                    </button>\n                    <button\n                      type=\"button\"\n                      className=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm\"\n                      onClick={() => setOpen(false)}\n                      ref={cancelButtonRef}\n                    >\n                      Cancel\n                    </button>\n                  </div>\n                </div>\n              </Transition.Child>\n            </div>\n          </Dialog>\n        </Transition.Root>\n         <div class=\"container mx-auto mt-10\">\n            <div class=\"flex shadow-md my-10\">\n              <div class=\"w-3/4 bg-gray-50 px-10 py-10\">\n                <div class=\"flex justify-between border-b pb-8\">\n                  <h1 class=\"font-semibold text-2xl\">Shopping Cart</h1>\n                  <h2 class=\"font-semibold text-2xl\">{products?.length} Items</h2>\n                </div>\n                <div class=\"flex mt-10 mb-5\">\n                  <h3 class=\"font-semibold text-gray-600 text-xs uppercase w-2/5\">Product</h3>\n                  <h3 class=\"font-semibold text-center text-gray-600 text-xs uppercase w-1/5 text-center\">Quantity</h3>\n                  <h3 class=\"font-semibold text-center text-gray-600 text-xs uppercase w-1/5 text-center\">Price</h3>\n                  <h3 class=\"font-semibold text-center text-gray-600 text-xs uppercase w-1/5 text-center\">Total</h3>\n                </div>\n\n                <StaticQuery\n                  query={graphql`\n                    {\n                      allRestApiApiProducts {\n                        edges {\n                          node {\n                            name\n                            category\n                            date\n                            description\n                            id\n                            price\n                            slug\n                            image {\n                              high\n                            }\n                            endpointId\n                          }\n                        }\n                      }\n                    }\n                  `}\n                  render={data => \n                    //if product id's are in cart items, display them in the cart\n                     data.allRestApiApiProducts.edges.map((product, key) =>  { \n                       if(products.includes(product.node.id)) {  \n                         //add price value to get total price value  \n                        addAllPrices(product.node.price);\n                        return <CartProduct data={product}/>\n                       }\n                    })\n                  }\n                ></StaticQuery>\n                <a href=\"/shop\" class=\"flex font-semibold text-indigo-600 text-sm mt-10\">\n              \n                  <svg class=\"fill-current mr-2 text-indigo-600 w-4\" viewBox=\"0 0 448 512\"><path d=\"M134.059 296H436c6.627 0 12-5.373 12-12v-56c0-6.627-5.373-12-12-12H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.569 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296z\"/></svg>\n                  Continue Shopping\n                </a>\n              </div>\n\n              <div id=\"summary\" class=\"w-1/2 px-8 py-10 bg-gray-100\">\n                <div className=\"flex flex-row justify-between border-b\" >\n                  <h1 class=\"font-semibold text-2xl pb-8\">Order Details</h1>\n                  {/* <div className=\"flex flex-row pt-1.5\">\n                    <h4 className=\"font-semibold px-1 text-gray-500 text-1xl\">Status: </h4>\n                    <span class=\"h-6 px-3  rounded-full bg-green-100 text-green-800\">\n                        Paid\n                    </span>\n                  </div> */}\n                </div>  \n                <div class=\"py-3\">\n                  <label for=\"promo\" class=\"font-semibold inline-block mb-3 text-sm uppercase\">Full Name</label>\n                  <input onChange={handleChange} type=\"name\" id=\"name\" name=\"name\" placeholder=\"Name\" class=\"p-2 text-sm w-full\" required/>\n                </div>\n                <div class=\"py-3\">\n                  <label for=\"promo\" class=\"font-semibold inline-block mb-3 text-sm uppercase\">Phone #</label>\n                  <input onChange={handleChange} type=\"phone\" id=\"phone\" name=\"phone\" placeholder=\"+6644584\" class=\"p-2 text-sm w-full\" required/>\n                </div>\n                <div class=\"flex flex-row justify-between\">\n                  <div className=\"py-3\">\n                    <label for=\"promo\" class=\"font-semibold inline-block mb-3 text-sm uppercase\">Promo code</label>\n                    <input onChange={handleChange} type=\"name\" id=\"promo\" name=\"promoCode\" placeholder=\"YES\" class=\"p-2 text-sm w-full\"/>\n                  </div>\n                  {/* <button class=\"bg-red-500 hover:bg-red-600 px-5 py-2 text-sm text-white mt-4 uppercase\">Apply</button> */}\n                </div>\n                {/* <a href=\"#\" class=\"flex font-semibold text-indigo-600 text-sm mt-5\">\n                    View Order\n                </a> */}\n                <div className=\"flex mt-6\">\n                    <label className=\"flex items-center\">\n                      <input type=\"checkbox\" class=\"form-checkbox\"/>\n                      <span class=\"ml-2\">I agree to the <span class=\"underline\">terms and conditions</span></span>\n                    </label>\n                </div>\n                <div className=\"flex mt-6\">\n                    <label className=\"flex items-center\">\n                      <input type=\"checkbox\" class=\"form-checkbox\"/>\n                      <span class=\"ml-2\">I agree to subscribe to recieve <span class=\"underline\"> SMS messages </span> to get notified on orders</span>\n                    </label>\n                </div>\n                <div class=\"border-t mt-8\">\n                  <div class=\"flex font-semibold justify-between py-6 text-sm uppercase\">\n                    <span>Total cost</span>\n                    <span>${totalSum}</span>\n                  </div>\n                  <button type=\"button\" onClick={handleOrder} disabled={canSubmit} class=\"bg-indigo-500 font-semibold hover:bg-indigo-600 disabled:opacity-50  py-3 text-sm text-white uppercase w-full\">Create Order{isLoading ? 'loading...' : ''}</button>\n                </div> \n              </div>\n            </div>\n          </div>\n    </Layout>\n  )\n}\n "],"sourceRoot":""}